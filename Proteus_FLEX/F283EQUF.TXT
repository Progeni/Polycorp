* F283EQUF
* .UTE TABLE ADDED AND CAN'T TRANSFER CHANGED
*
* DOS I/O EQUATES. STRINGS. COMMAND TABLE
*
LINBUF EQU $C080 LINE BUFFER
LC0FF EQU $C0FF TOP OF STACK
CMDADR EQU $C100 UTILITY COMMAND SPACE (1.5 K)
SYFCB2 EQU $C980 SYSTEM FILE CONTROL BLOCK 2

* S-BUG MONITOR REFERENCES

SWI3V EQU $DFC2 SOFTWARE INTERRUPT 3 VECTOR
IRQV EQU $DFC8 INTERRUPT VECTOR
ACIAAD EQU $DFE0 RE-VECTORABLE CONTROL PORT
sINCH EQU $F804 INPUT CHARACTER, NO ECHO
INCHE EQU $F806 INPUT CHARACTER,CAND ECHO
INCHEK EQU $F808 CHECK FOR INPUT CHARACTER
sOUTCH EQU $F80A OUTPUT CHARACTER

* ASCII CODE EQUATES

NUL EQU $00
EOT EQU $04
NAK EQU $15


 ORG $CC00

TTYBS FCB 8 BACKSPACE CHARACTER

TTYDEL FCB $18 DELETE CHARACTER

TTYEOL FCB $3A END OF LINE CHARACTER

TTYDP FCB 0 DEPTH COUNT

TTYWD FCB 0 WIDTH COUNT

TTYNL FCB 0 NULL COUNT

TTYTB FCB 0 TAB CHARACTER

TTYBE FCB 8 BACKSPACE ECHO CHARACTER

TTYEJ FCB 0 EJECT COUNT

TTYPS FCB $FF PAUSE CONTROL BYTE

TTYESC FCB $1B ESCAPE CHARACTER

SYSDRV FCB 0 SYSTEM DRIVE NUMBER

WRKDRV FCB 0 WORKING DRIVE NUMBER

SYSFLG FCB 0 USE SYSTEM DRIVE FLAG

* SYSTEM DATE REGISTERS

SYSMTH RMB 1 MONTH - LEAVE HOLES IN CASE VALID...

SYSDAY RMB 1 DAY

SYSYR RMB 1 YEAR

LSTTRM FCB 0 LAST TERMINATOR CHARACTER

UCMDTB FDB 0 USER COMMAND TABLE ADDRESS

LINPTR FDB 0 LINE BUFFER POINTER

ESCRET FDB 0 ESCAPE RETURN REGISTER

CURCHR FCB 0 CURRENT CHARACTER

PRVCHR FCB 0 PREVIOUS CHARACTER

CURLIN FCB 0 CURRENT LINE COUNT

LDROFF FDB 0 LOADER ADDRESS OFFSET DATA

XFERFG FCB 0 TRANSFER FLAG

XFERAD FDB 0 TRANSFER ADDRESS

ERRTYP FCB 0 ERROR TYPE

SPECIO FCB 0 SPECIAL I/O FLAG

OUTSW FCB 0 OUTPUT SWITCH

INSW FCB 0 INPUT SWITCH

OUTFIL FDB 0 FILE OUTPUT ADDRESS

INFIL FDB 0 FILE INPUT ADDRESS

CMDFLG FCB 0 COMMAND FLAG

CURCLM FDB 0 CURRENT OUTPUT COLUMN

MEMEND FDB 0 MEMORY END

ERRVEC FDB 0 ERROR NAME VECTOR

FILEKO FCB 1 FILE INPUT ECHO FLAG

FMSBSY FCB 0 FLEX ALREADY BUSY FLAG

LCC31 FDB 0 SCRATCH

CPUTYP FCB 0 CPU TYPE FLAG

* CPU TYPE FLAG BIT DEFINITIONS
*
CPU_2MHZ EQU %10000000 1 => 2 MHz CPU CLOCK RATE
CPU_SLOW EQU %01000000 1 => MEMORY STRETCH ACTIVE
CPU_50HZ EQU %00100000 1 => 50 Hz POWER LINE FREQUENCY
CPU_RAMF EQU %00010000 1 => CPU RAM AVAILABLE
CPU_RTCK EQU %00001000 1 => 6819 REAL TIME CLOCK AVAILABLE
CPU_IOBX EQU %00000100 1 => I/O SET UP (ADDRESSED 4 OR 16 APART)
CPU_TIME EQU %00000010 1 => 6840 TIMER AVAILABLE
CPU_XMEM EQU %00000001 1 => EXTENDED MEMORY IS USED

LCC34 FCB 0

PRTADR FDB 0 PRINTER RESERVED AREA POINTER

PRTLNG FDB 0 PRINTER RESERVED AREA LENGTH

PRTDVC FDB 0 PRINTER DEVICE ADDRESS

FLADDR EQU $CC3D

CMDPTR EQU $CC3F COMMAND INPUT CHARACTER POINTER

DOCRTN EQU $CC43 DOCMD RETURN ADDRESS

LCC45 EQU $CC45

LCC47 EQU $CC47

 ORG $CC49

ULCFLG FCB $60 UPPER/LOWER CASE MAP FLAG

LCC4A EQU $CC4A

MAXFN EQU $CC4B MAXIMUM FILENAME LENTGH

LCC4C EQU $CC4C

LCC4D EQU $CC4D

 ORG $CC4E

PROMPT FDB FPRMPT POINTER TO PROMPT STRING

WHAT FCC "Pardon?",EOT

NO_TFR FCC "No Transfer   ",EOT

DSKERR FCC "DISK ERROR #",EOT

NREADY FCC "Disk drive not ready",EOT

 IF *>=$CC8D
 ERR ERROR AT CC8C COMMAND TABLE
 ENDIF

 ORG $CC8C

CMDTBL FCC "GET"
 FCB $00
 FDB GETCAL
 FCC "MON"
 FCB $00
 FDB MONCAL
 FCB $00

LCC99 FCB $27,$10,$03,$E8,$00,$64,$00
 FCB $0A

ERRORS FCC "errors",NUL,NUL,"sys"

FPRMPT FCC "+++"
 FCB 4

 ORG $CCC0

PINIT RTS PRINTER INITIALISE VECTOR

* USE .UTE JUMP TABLE FOR FLEXP 2.8:3
* for using POLY .UTE commands from FLEXP
* 14.7.82
*
PINITA JMP GETCHR
 JMP PUTCHR
 JMP INBUFF
 JMP PSTRNG
 JMP PCRLF
 JMP OUTDEC
 JMP OUTHEX

PTERM EQU $CCD0 PRINTER CLOSE VECTOR

 ORG $CCD8

PCHK RTS PRINTER READY CHECK VECTOR

* USE .UTE JUMP TABLE FOR FLEXP 2.8:3
* for using POLY .UTE commands from FLEXP
* 14.7.82
*
PCHKA JMP OUTADR

 ORG $CCE4

POUT RTS PRINTER CHARACTER OUTPUT ROUTINE

 ORG $CCF8

SCR_D FCB $01,$00,$00,$00

PRCFLG FCB $00 ACTIVE SPOOLING PROCESS FLAG

 FCB $00,$00,$00

